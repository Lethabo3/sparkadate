console.log('Plan script loaded')

const freePlan = document.getElementById('freePlan')
const proPlan = document.getElementById('proPlan')
const continueBtn = document.getElementById('continueBtn')

console.log('Elements found:', { freePlan, proPlan, continueBtn })

let selectedPlan = 'pro'

freePlan.addEventListener('click', () => {
    freePlan.classList.add('selected')
    proPlan.classList.remove('selected')
    selectedPlan = 'free'
    continueBtn.textContent = 'Continue with Free'
})

proPlan.addEventListener('click', () => {
    proPlan.classList.add('selected')
    freePlan.classList.remove('selected')
    selectedPlan = 'pro'
    continueBtn.textContent = 'Continue with Pro'
})

continueBtn.addEventListener('click', () => {
    console.log('Button clicked, selectedPlan:', selectedPlan)
    if (selectedPlan === 'pro') {
        const user = JSON.parse(localStorage.getItem('sparkUser'))
        console.log('User from storage:', user)
        if (user && user.id) {
            const checkoutUrl = `https://spark-thesocialapp.lemonsqueezy.com/checkout/buy/ee335969-d3c6-4835-8097-2610b43e7f2f?checkout[custom][user_id]=${user.id}`
            console.log('Redirecting to:', checkoutUrl)
            window.location.href = checkoutUrl
        } else {
            console.log('No user found, going to login')
            window.location.href = 'login.html'
        }
    } else {
        console.log('Free plan selected, going to chat')
        window.location.href = 'chat.html'
    }
})

console.log('Event listeners attached')
